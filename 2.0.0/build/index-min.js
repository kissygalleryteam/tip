/*!build time : 2014-07-31 8:11:41 PM*/
KISSY.add("kg/tip/2.0.0/node-extension",function(a,b,c){"use strict";a.augment(a.Node,{beyondViewPortRegion:function(b){function d(a,b){return a>=i+e&&i+h-e>=a&&b>=j+e&&j+g-e>=b?!0:!1}var e,f=this;e=a.isUndefined(b)?0:b;var g,h,i,j,k=f.offset();return g=c.viewportHeight(),h=c.viewportWidth(),i=c.scrollLeft(),j=c.scrollTop(),{start:d(k.left,k.top),end:d(k.left+f.width(),k.top+f.height())}},inViewportRegion:function(a){var b=this,c=b.beyondViewPortRegion(a);return c.start&&c.end?!0:!1}})},{requires:["node","dom"]}),KISSY.add("kg/tip/2.0.0/index",function(a){"use strict";var b=(a.Node.all,a.Overlay),c=[["tc","bc","bc"],["bc","tc","tc"],["tl","br",""],["tl","bl","bl"],["bl","tr",""],["bl","br","rb"],["bl","tl","tl"],["br","tl",""],["br","bl","lb"],["br","tr","tr"],["tr","br","br"],["tr","bl",""],["tr","tl","lt"],["cr","cl","lc"],["tl","tr","rt"],["cl","cr","rc"]],d=['<div class="z-tip">','<span class="z-taper"></span>','<span class="z-close">x</span>','<div class="z-wrapper">','<div class="hd">',"</div>",'<div class="bd">',"</div>","</div>","</div>"].join(""),e=[],f=function(){this._init.apply(this,arguments)};return a.augment(f,a.Event.Target,{_init:function(b,c){var d=this;return a.isString(b)&&(b=a.one(b)),d.target=b,d._buildParam(c),d._buildHtml(),d._bindEvent(),this.firstShow=!0,this},_bringToTop:function(){var a=this;return a.con.css("z-index",a.zIndex++),this},setContent:function(b){var c=this;return a.isString(b)?c.con.one(".bd").html(b):c.con.one(".bd").empty().append(b),this},setHeader:function(a){var b=this;return b.con.one(".hd").html("<b>"+a+"</b>"),this},_buildHtml:function(){var c=this,e=a.Node(d);return e.css({visibility:"hidden",position:"absolute"}).appendTo(a.one("body")),c.con=e,c.popup=new b.Popup({srcNode:e,align:{node:c.target,points:c.points,offset:[c.offsetX,c.offsetY]},effect:{effect:c.effect,duration:c.duration}}),c.useTitle&&c._getTitleAsData(),c.display=c.con.css("display"),c.tipClass&&(c.con.addClass(c.tipClass),c.con.removeClass("z-tip")),c.closeable&&c.con.one(".z-close").css("display","block"),this},rePosition:function(){var a=this,b=a.popup.get("align");return a.popup.align(a.target,b.points,b.offset),a.arrow&&a.renderArrow(),this},_getTitleAsData:function(){var a=this,b=a.target.attr("title");return""!==b&&(a.target.attr("data-title",b),a.target.attr("title","")),a.target.attr("data-title")},_bindEvent:function(){var b=this;return a.each(b.showOn,function(a){b.target.on(a,function(a){b.hiddingTimer&&clearTimeout(b.hiddingTimer),b.isShowing()||(a.preventDefault(),b.showingTimer=setTimeout(function(){b.show()},b.delayIn))})}),a.each(b.hideOn,function(a){b.target.on(a,function(){b.showingTimer&&clearTimeout(b.showingTimer),b.isShowing()&&(b.hiddingTimer=setTimeout(function(){b.hide()},b.delayOut))})}),b.con.one(".z-close").on("click",function(){b.hide()}),b.mouseHook&&a.Event.on("body","mousemove",function(a){e=[a.pageX,a.pageY],b.withMouseMove&&b._positionWithMouse()}),b.hideOnEmptyClick&&a.Event.on(document,"click",function(a){a.target==b.con.getDOMNode()||a.target==b.target.getDOMNode()||b.target.contains(a.target)||b.con.contains(a.target)||b.hide()}),a.Event.on(window,"resize",function(){b.rePosition(),b.rerender(),b.renderArrow()}),b.fleeting||(b.con.on("mouseenter",function(){b.hiddingTimer&&clearTimeout(b.hiddingTimer)}),b.con.on("mouseleave",function(){b.hiddingTimer=setTimeout(function(){b.hide()},b.delayOut)})),this},isShowing:function(){var a=this;return"hidden"!=a.con.css("visibility")?!0:!1},hide:function(){var a=this;return a.fire("beforeHide")===!1?this:(a.popup.hide(),a.con.css("display","none"),a.fire("afterHide"),a.fire("hide"),a._teardown(),this)},_teardown:function(){var b=this;return function(){if(b.arrow&&b._arrowPos&&""!==b._arrowPos){var c=a.clone(b.popup.get("align"));switch(b._arrowPos.charAt(0)){case"l":c.offset[0]-=b.aOffset;break;case"r":c.offset[0]+=b.aOffset;break;case"t":c.offset[1]-=b.aOffset;break;case"b":c.offset[1]+=b.aOffset}b.popup.align(b.target,c.points,c.offset)}}(),this},_renderContent:function(a){var b=this,c=a?a:b.contentText?b.contentText:b.getConentText.call(b,b.target),d=b.headerText?b.headerText:b.getHeaderText.call(b,b.target);return c&&b.setContent(c),d&&b.setHeader(d),this},_positionWithMouse:function(){var a=this;return a.popup.set("x",e[0]-4+a.offsetX),a.popup.set("y",e[1]+20+a.offsetY),this},show:function(a){var b=this;return b.fire("beforeShow")===!1?this:(b.con.css("display",b.display),b.staticContent?(b.firstShow&&b._renderContent(a),b.firstShow=!1):b._renderContent(a),b.con.css("visibility","hidden"),b.popup.show(),b.con.css("visibility",""),b.fire("afterShow"),b.fire("show"),b.mouseHook&&b._positionWithMouse(),b.smarty&&b.smartyPosition(),b.arrow&&b.renderArrow(),b._bringToTop(),this)},_getArrowPos:function(){for(var a,b=this,d=b.popup.get("align"),e=0;e<c.length;e++)if(c[e][0]==d.points[0]&&c[e][1]==d.points[1]){a=c[e][2];break}return a},renderArrow:function(){var b=this;if(!b.arrow)return this;if(a.each(c,function(a){b.con.removeClass(a[2])}),b.mouseHook)return this;var d=b._getArrowPos();if(b._arrowPos=d,""===d)return this;b.con.height()<=36&&("l"==d.charAt(0)||"r"==d.charAt(0))&&(d=d.charAt(0)+"c"),b.con.width()<=36&&("t"==d.charAt(0)||"b"==d.charAt(0))&&(d=d.charAt(0)+"c"),b.con.addClass(d);var e=(b.popup.get("x"),b.popup.get("y"),a.clone(b.popup.get("align")));switch(d.charAt(0)){case"l":e.offset[0]+=b.aOffset;break;case"r":e.offset[0]-=b.aOffset;break;case"t":e.offset[1]+=b.aOffset;break;case"b":e.offset[1]-=b.aOffset}return b.popup.align(b.target,e.points,e.offset),this},rerender:function(){var a=this;return a.smartyPosition(),this},smartyPosition:function(){function a(){if(!b.con.inViewportRegion(0)&&0!==d.length){var c=d.pop();b.popup.set("align",{node:b.target,points:c,offset:[b.offsetX,b.offsetY]}),b.arrow&&(b.renderArrow(),b.revise(b._getArrowPos())),a()}}var b=this;if(b.mouseHook||b.popup.set("align",{node:b.target,points:b.points,offset:[b.offsetX,b.offsetY]}),!b.smarty)return this;var d=c.concat().reverse();a()},_buildParam:function(b){function c(a,c){var d=b[c];e[c]=void 0===d||null===d?a:d}function d(b){a.isString(e[b])&&(e[b]=[e[b]])}var e=this;(void 0===b||null===b)&&(b={}),a.each({delayIn:300,delayOut:100,showOn:"mouseenter",hideOn:"mouseleave",hideOnEmptyClick:!0,revise:function(){},zIndex:100,aOffset:7,withMouseMove:!1,contentText:!1,headerText:!1,getHeaderText:function(){return""},staticContent:!1,useTitle:!0,dataSegment:"title",effect:"fade",points:["bc","tc"],mouseHook:!0,fleeting:!0,duration:.2,tipClass:"",smarty:!0,closeable:!1,arrow:!0,showLoading:!0,offsetX:0,offsetY:0},c);var f=function(){};return f=function(a){var b=a.attr(e.dataSegment);return""!==b&&(a.attr(e.dataSegment,""),a.attr("data-title",b)),a.attr("data-title")},a.each({getConentText:f},c),a.each(["showOn","hideOn"],d),a.UA.ie<=8&&(e.effect="none"),this}}),f},{requires:["overlay","./node-extension"]});